<html>
    <head>
        <title>Hello world</title>
    </head>
    <body>
        <script src="codemirror/lib/codemirror.js"></script>
        <script src="codemirror/lib/util/formatting.js"></script>
        <script src="codemirror/lib/util/dialog.js"></script>
        <link rel="stylesheet" href="codemirror/lib/codemirror.css">
        <link rel="stylesheet" href="codemirror/lib/util/dialog.css">
        <link rel="stylesheet" href="seashell.css">
        <script src="codemirror/mode/clike/clike.js"></script>


    <div id="container">
        <div class="right">Logged in as <span class="userid">ctdalek</span> - <a href="">Logout</a></div>
        <h1>Seashell, the C Shell</h1>
        <div id="top">
            <span class="buttons left">
                <button type="button" id="undo">Undo</button>
                <button type="button" id="redo">Redo</button>
                <button type="button" id="save">Save</button>
                <button type="button" id="open-file">Open...</button>
                <button type="button" id="new-file">New...</button>
            </span>
            <span class="buttons right">
                <!--
                <button type="button" id="indent">Indent</button>
                <button type="button" id="unindent">Unindent</button>
                -->
                <button type="button" id="autoindent">Indent</button>
                <button type="button" id="comment">Comment</button>
                <button type="button" id="uncomment">Uncomment</button>
                <button type="button" id="goto-line">Goto...</button>
            </span>

            <span class="filename">foobar.c</span>

            <div id="codeArea">
                <textarea id="seashell">
#include <stdio>
int main() {
    printf("hello world");
    return(0);
}</textarea>
            </div>
        </div>
        <div id="bottom">
            <span class="buttons">
                <button type="button" id="check-syntax">Check Syntax</button>
                <button type="button">Compile</button>
                <button type="button">Run</button>
                <button type="button">Run with input...</button>
                <button type="button">Test with RunC</button>

            </span>
            <span class="buttons right">
                <button type="button">Submit to Marmoset</button>
            </span>
            <div id="prompt">&gt; ls</div>

        </div>
    </div> <!-- container -->

        <script type="application/javascript">
            function giveAction(elid,act) {
                document.getElementById(elid).onclick=act;
            }
            var seashellEditor = document.getElementById('seashell');
            //var txt = document.createTextNode("woohoo");
            //seashellEditor.appendChild(txt);
            var editor = CodeMirror.fromTextArea(seashellEditor, {lineNumbers: true});

            function toggleCommentHandler(isC) {
                //var from = editor.getCursor(true);
                //var to = editor.getCursor(false);
                editor.commentRange(isC, editor.getCursor(true), editor.getCursor(false));
            }
            function autoIndentHandler() {
                var from = editor.getCursor(true);
                var to = editor.getCursor(false);
                editor.autoFormatRange(from, to);
            }

            function gotoHandler() {
                var gotoPrompt = 'Line: <input type="text" style="width: 3em"/>';
                editor.openDialog(gotoPrompt, function(query) {
                        editor.setCursor(query-1, 0); });
            }

            giveAction("undo", function() {editor.undo();});
            giveAction("redo", function() {editor.redo();});
                    
            giveAction("comment", function() {toggleCommentHandler(true);});
            giveAction("uncomment", function() {toggleCommentHandler(false);});
            giveAction("autoindent", autoIndentHandler);
            giveAction("goto-line", gotoHandler);
        </script>

    </body>
</html>
